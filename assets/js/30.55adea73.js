(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{590:function(a,s,e){"use strict";e.r(s);var t=e(14),r=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"_1-概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[a._v("#")]),a._v(" 1.概述")]),a._v(" "),e("ul",[e("li",[a._v("访问一个k8s集群的时候，需要经过三个步骤完成具体操作\n"),e("ol",[e("li",[a._v("第一步：认证")]),a._v(" "),e("li",[a._v("第二步：鉴权")]),a._v(" "),e("li",[a._v("第三步：准入控制")])])]),a._v(" "),e("li",[a._v("进行访问的时候，在这个过程中都需要经过 api-server\n"),e("ul",[e("li",[a._v("api-server做统一协调。比如门卫")]),a._v(" "),e("li",[a._v("访问过程中需要证书、token、或者用户名+密码")]),a._v(" "),e("li",[a._v("如果访问pod需要 serviceAccount")])])])]),a._v(" "),e("h3",{attrs:{id:"_1-1认证"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1认证"}},[a._v("#")]),a._v(" 1.1认证")]),a._v(" "),e("ul",[e("li",[a._v("传输安全：\n"),e("ul",[e("li",[a._v("比如对外不暴露8080端口，只能内部访问，对外使6443")])])]),a._v(" "),e("li",[a._v("客户端身份认证常用方式\n"),e("ul",[e("li",[a._v("https证书认证，基于ca证书")]),a._v(" "),e("li",[a._v("http token认证，通过token识别用户")]),a._v(" "),e("li",[a._v("http基本认证：用户名+密码 认证")])])])]),a._v(" "),e("h3",{attrs:{id:"_1-2-鉴权"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-鉴权"}},[a._v("#")]),a._v(" 1.2.鉴权")]),a._v(" "),e("ul",[e("li",[a._v("基于RBAC鉴权操作\n"),e("ul",[e("li",[a._v("RABC： 基于角色访问控制")])])])]),a._v(" "),e("h3",{attrs:{id:"_1-3-准入控制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-准入控制"}},[a._v("#")]),a._v(" 1.3.准入控制")]),a._v(" "),e("p",[a._v("就是进行准入控制的列表，如果列表中有请求内容则通过，没有就拒绝")]),a._v(" "),e("h2",{attrs:{id:"_2-rbac-role-based-access-control-基于角色的访问控制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-rbac-role-based-access-control-基于角色的访问控制"}},[a._v("#")]),a._v(" 2.RBAC-Role-Based Access Control:基于角色的访问控制")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://www.rishiqing.com/task/v1/folder/file/url?signature=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidmlldyIsImlhdCI6MTY1MDE4NzE2MSwiZmlsZUlkIjo2Mjc3MzgwLCJ0aW1lc3RhbXAiOjE2NTAxODcxNjE1NzV9.A8EzNc2yk10iOVKFeINfSjxGWrt23B7iuJvgzk85iKY",alt:"图示"}})]),a._v(" "),e("h3",{attrs:{id:"角色"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#角色"}},[a._v("#")]),a._v(" 角色")]),a._v(" "),e("p",[a._v("role：特定命名空间访问权限 （kubectl create ns xxx）")]),a._v(" "),e("p",[a._v("ClusterRole：对所有命名空间访问权限")]),a._v(" "),e("h3",{attrs:{id:"角色绑定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#角色绑定"}},[a._v("#")]),a._v(" 角色绑定")]),a._v(" "),e("p",[a._v("roleBinding：角色绑定到主体")]),a._v(" "),e("p",[a._v("ClusterRoleBinding：集群角色绑定到主体")]),a._v(" "),e("h3",{attrs:{id:"主体"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主体"}},[a._v("#")]),a._v(" 主体")]),a._v(" "),e("p",[a._v("user：用户")]),a._v(" "),e("p",[a._v("group：用户组")]),a._v(" "),e("p",[a._v("serviceAccount：服务账号")]),a._v(" "),e("h3",{attrs:{id:"举一个🌰"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#举一个🌰"}},[a._v("#")]),a._v(" 举一个🌰")]),a._v(" "),e("ol",[e("li",[a._v("创建一个命名空间")])]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("kubectl create ns roledemo\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[a._v("在新创建的命名空间创建一个pod")])]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("kubectl run nginx --image"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("nginx -n roledemo\nkubectl -n reoledemo get   pods\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[a._v("创建角色-通过yaml配置文件创建\n"),e("img",{attrs:{src:"https://www.rishiqing.com/task/v1/folder/file/url?signature=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidmlldyIsImlhdCI6MTY1MDE4NzkzMywiZmlsZUlkIjo2Mjc3NDEwLCJ0aW1lc3RhbXAiOjE2NTAxODc5MzM3MDF9.-d-zr95DB1apgonWNafxwtXfSG9d3J3cnRlHuqBmzQg",alt:"图示"}})])]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("kubectl create -f rbac-role.yaml\nkubectl get role -n roledemo\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("ol",{attrs:{start:"4"}},[e("li",[a._v("创建角色绑定\n"),e("img",{attrs:{src:"https://www.rishiqing.com/task/v1/folder/file/url?signature=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidmlldyIsImlhdCI6MTY1MDE4ODM3MiwiZmlsZUlkIjo2Mjc3NDI0LCJ0aW1lc3RhbXAiOjE2NTAxODgzNzIwOTF9.avz9eFbYr99vp-wqXQHbuS8SciIxkyGOBuEVb-B7RZ8",alt:"图示"}})])]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("kubectl apply -f rbac-rolebinding.yaml\nkubectl get role,rolebinding -n roledemo\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br")])]),e("ol",{attrs:{start:"5"}},[e("li",[a._v("使用证书识别身份")])])])}),[],!1,null,null,null);s.default=r.exports}}]);