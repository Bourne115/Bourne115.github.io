(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{601:function(s,a,t){"use strict";t.r(a);var n=t(14),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一句话简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一句话简介"}},[s._v("#")]),s._v(" 一句话简介")]),s._v(" "),t("ul",[t("li",[s._v("基于 Node.js：Node.js 模块")]),s._v(" "),t("li",[s._v("下一代：蚕食第一代 Web 框架 Express 的市场")]),s._v(" "),t("li",[s._v("Web 框架")])]),s._v(" "),t("h2",{attrs:{id:"洋葱-🧅-模型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#洋葱-🧅-模型"}},[s._v("#")]),s._v(" 洋葱 🧅 模型")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("    // 演示洋葱模型\n    app.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("async "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx,next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1-1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    await next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1-2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    app.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("async "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx,next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2-1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    await next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2-2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    app.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("async "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx,next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3-1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    await next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3-2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    app.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("async "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx,next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'4-1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    await next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'4-2'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    app.use"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("async "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ctx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console.log"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'5'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    ctx.body "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br")])]),t("h2",{attrs:{id:"路由是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#路由是什么"}},[s._v("#")]),s._v(" 路由是什么")]),s._v(" "),t("ul",[t("li",[s._v("决定了不同 URL 是如何被不同地执行的")]),s._v(" "),t("li",[s._v("在 Koa 中，是一个中间件")])]),s._v(" "),t("h2",{attrs:{id:"为什么要用路由"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用路由"}},[s._v("#")]),s._v(" 为什么要用路由？")]),s._v(" "),t("ul",[t("li",[s._v("如果没有路由，会怎么样？\n"),t("ul",[t("li",[s._v("所有请求都做了相同的事情")]),s._v(" "),t("li",[s._v("所有请求都会返回相同的结果")])])])]),s._v(" "),t("h2",{attrs:{id:"状态-🐴"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#状态-🐴"}},[s._v("#")]),s._v(" 状态 🐴")]),s._v(" "),t("ul",[t("li",[s._v("运行时错误，都返回 500")]),s._v(" "),t("li",[s._v("逻辑错误 404（不存在）412（先决条件失败）422（无法处理的实体，参数格式不对等等）")])]),s._v(" "),t("h2",{attrs:{id:"为什么要用错误处理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用错误处理"}},[s._v("#")]),s._v(" 为什么要用错误处理")]),s._v(" "),t("ul",[t("li",[s._v("防止程序挂掉")]),s._v(" "),t("li",[s._v("try catch finally")]),s._v(" "),t("li",[s._v("告诉用户错误信息")]),s._v(" "),t("li",[s._v("便于开发者调试")])]),s._v(" "),t("h2",{attrs:{id:"koa-json-error-进行错误处理中间件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#koa-json-error-进行错误处理中间件"}},[s._v("#")]),s._v(" koa-json-error 进行错误处理中间件")]),s._v(" "),t("h2",{attrs:{id:"koa-parameter-校验参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#koa-parameter-校验参数"}},[s._v("#")]),s._v(" koa-parameter 校验参数")]),s._v(" "),t("h2",{attrs:{id:"什么是-nosql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是-nosql"}},[s._v("#")]),s._v(" 什么是 NoSQL ？")]),s._v(" "),t("ul",[t("li",[s._v("对不同于传统的关系型数据库的数据管理系统的统称")])]),s._v(" "),t("h2",{attrs:{id:"nosql-数据库的分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nosql-数据库的分类"}},[s._v("#")]),s._v(" NoSQL 数据库的分类")]),s._v(" "),t("ul",[t("li",[s._v("列存储 （HBase）")]),s._v(" "),t("li",[s._v("文档存储 （MongoDB）")]),s._v(" "),t("li",[s._v("key-value 存储（Redis）")]),s._v(" "),t("li",[s._v("图存储 （FlockDB）")]),s._v(" "),t("li",[s._v("对象存储 （db4o）")]),s._v(" "),t("li",[s._v("XML 存储 （BaseX）")])]),s._v(" "),t("h2",{attrs:{id:"为什么要用-nosql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用-nosql"}},[s._v("#")]),s._v(" 为什么要用 NoSQL")]),s._v(" "),t("ul",[t("li",[s._v("简单（没有原子性、一致性、隔离性等复杂规范）")]),s._v(" "),t("li",[s._v("便于横向拓展")]),s._v(" "),t("li",[s._v("适合超大规模数据的存储")]),s._v(" "),t("li",[s._v("很灵活地存储复杂结构的数据 （Schema Free）")])]),s._v(" "),t("h2",{attrs:{id:"为什么要用-mongodb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么要用-mongodb"}},[s._v("#")]),s._v(" 为什么要用 MongoDB？")]),s._v(" "),t("ul",[t("li",[s._v("性能好（内存计算）")]),s._v(" "),t("li",[s._v("大规模数据存储（可拓展性）")]),s._v(" "),t("li",[s._v("可靠安全 （本地复制、自动故障转移）")]),s._v(" "),t("li",[s._v("方便存储复杂数据结构（Schema Free）")])]),s._v(" "),t("h2",{attrs:{id:"云-mongodb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#云-mongodb"}},[s._v("#")]),s._v(" 云 MongoDB")]),s._v(" "),t("p",[s._v("MongoDB Atlas")]),s._v(" "),t("div",{staticClass:"language-zsh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v(" mongodb+srv://qile:<password>@cluster0.cce0o.mongodb.net/myFirstDatabase?retryWrites=true&w=majority\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"session-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#session-简介"}},[s._v("#")]),s._v(" Session 简介")]),s._v(" "),t("p",[t("img",{attrs:{src:"'https://www.rishiqing.com/task/v1/folder/file/url?signature=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0eXBlIjoidmlldyIsImlhdCI6MTY2MTgyMzkxNiwiZmlsZUlkIjo3MDE3Mjc3LCJ0aW1lc3RhbXAiOjE2NjE4MjM5MTYxNTV9.XolKxcPvqfAqgMbbvhBaP1HXGW_PSBoBMlP00H7jpsw'",alt:"session工作原理"}})]),s._v(" "),t("h2",{attrs:{id:"session-的优势"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#session-的优势"}},[s._v("#")]),s._v(" Session 的优势")]),s._v(" "),t("ul",[t("li",[s._v("相比 JWT，最大优势就在于可以主动清除 session 了")]),s._v(" "),t("li",[s._v("session 保存在服务器端，相对较为安全")]),s._v(" "),t("li",[s._v("结合 cookie 使用，较为灵活，兼容性较好")])]),s._v(" "),t("h2",{attrs:{id:"session-的劣势"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#session-的劣势"}},[s._v("#")]),s._v(" session 的劣势")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("cookie + session 在跨域场景表现并不好")]),s._v(" "),t("blockquote",[t("p",[s._v("是因为设置 cookie 的时候 并不只设置 session id 还有 domain 表示 cookie 只有这个域名下才会生效")])])]),s._v(" "),t("li",[t("p",[s._v("如果是分布式部署，需要做多机共享 session 机制。")]),s._v(" "),t("blockquote",[t("p",[s._v("因为 session 一般都保存在内存中 多机部署时要考虑 session 的共享")])])]),s._v(" "),t("li",[t("p",[s._v("基于 cookie 的机制很容易被 CSRF （跨站请求伪造）")])]),s._v(" "),t("li",[t("p",[s._v("查询 session 信息可能会有数据库查询操作")]),s._v(" "),t("blockquote",[t("p",[s._v("可能是将 sessionId 给客户端，那 session 的完整信息就会存在数据库")])])]),s._v(" "),t("li",[t("p",[s._v("sessionStorage： 仅在当前会话下有效，关闭页面或浏览器后被清除")])]),s._v(" "),t("li",[t("p",[s._v("localStorage：除非被清除，否则永久保存，因为它是存在本地的内存中")])])]),s._v(" "),t("h2",{attrs:{id:"什么是-jwt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是-jwt"}},[s._v("#")]),s._v(" 什么是 JWT")]),s._v(" "),t("ul",[t("li",[s._v("JSON Web Token 是一个开放标准（RFC7519）")]),s._v(" "),t("li",[s._v("定义了一种紧凑并且独立的方式，可以将各方之间的信息作为 JSON 对象进行安全传输")]),s._v(" "),t("li",[s._v("该信息可以验证和信任，因为是经过数字签名的")])]),s._v(" "),t("h2",{attrs:{id:"jwt-的构成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt-的构成"}},[s._v("#")]),s._v(" JWT 的构成")]),s._v(" "),t("ul",[t("li",[s._v("头部（header）")]),s._v(" "),t("li",[s._v("有效载荷 （Payload）")]),s._v(" "),t("li",[s._v("签名（Signature）")])]),s._v(" "),t("h2",{attrs:{id:"jwt-vs-session"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt-vs-session"}},[s._v("#")]),s._v(" JWT vs Session")]),s._v(" "),t("ul",[t("li",[s._v("可拓展性 水平拓展（其实就是加服务器） 垂直拓展（增加每台服务器的硬件性能 eg 磁盘、内存、cpu）")]),s._v(" "),t("li",[s._v("安全性 XSS（跨站脚本攻击，要签名、加密）CSRF （跨站请求伪造、cookie） 重放攻击 中间人攻击（https）")]),s._v(" "),t("li",[s._v("RESTful API")]),s._v(" "),t("li",[s._v("性能 比 session 弱 JWT 比较大 http 请求开销大 SessionId 又需要让后端去查对应的数据")]),s._v(" "),t("li",[s._v("时效性 比 session 差一点 只有等过期了才能销毁 但 session 可以在后端在程序中销毁")])]),s._v(" "),t("h2",{attrs:{id:"在-nodejs-中使用-jwt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-nodejs-中使用-jwt"}},[s._v("#")]),s._v(" 在 Nodejs 中使用 JWT")]),s._v(" "),t("ul",[t("li",[s._v("安装 jsonwebtoken 这个 npm 包")]),s._v(" "),t("li",[s._v("签名")]),s._v(" "),t("li",[s._v("验证")])]),s._v(" "),t("h2",{attrs:{id:"在-nodejs-中使用-koa-jwt-来鉴权"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-nodejs-中使用-koa-jwt-来鉴权"}},[s._v("#")]),s._v(" 在 Nodejs 中使用 koa-jwt 来鉴权")]),s._v(" "),t("ul",[t("li",[s._v("使用这个 koa-jwt 来对接口做鉴权")]),s._v(" "),t("li")]),s._v(" "),t("h2",{attrs:{id:"上传图片的需求场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传图片的需求场景"}},[s._v("#")]),s._v(" 上传图片的需求场景")]),s._v(" "),t("ul",[t("li",[s._v("用户头像")]),s._v(" "),t("li",[s._v("封面图片")]),s._v(" "),t("li",[s._v("问题和回答中的图片")]),s._v(" "),t("li",[s._v("话题图片")])]),s._v(" "),t("h2",{attrs:{id:"上传图片的功能点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传图片的功能点"}},[s._v("#")]),s._v(" 上传图片的功能点")]),s._v(" "),t("ul",[t("li",[s._v("基础功能：上床图片、生成图片链接")]),s._v(" "),t("li",[s._v("附加功能： 限制上传图片的大小与类型、生成高中低三种分辨率的图片链接、生成 CDN")])]),s._v(" "),t("h2",{attrs:{id:"上传图片的技术方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#上传图片的技术方案"}},[s._v("#")]),s._v(" 上传图片的技术方案")]),s._v(" "),t("ul",[t("li",[s._v("阿里云的 OSS 等云服务，推荐在生产环境")]),s._v(" "),t("li",[s._v("直接上传到服务器，不推荐在生产环境下中使用")])]),s._v(" "),t("h2",{attrs:{id:"使用-koa-body-来获取上传的文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-koa-body-来获取上传的文件"}},[s._v("#")]),s._v(" 使用 koa-body 来获取上传的文件")]),s._v(" "),t("ul",[t("li",[s._v("安装 koa-body。替换 koa-bodyparser")]),s._v(" "),t("li",[s._v("设置图片上传目录")]),s._v(" "),t("li",[s._v("使用 postman 上传文件")])]),s._v(" "),t("h2",{attrs:{id:"使用-koa-static-生成图片链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-koa-static-生成图片链接"}},[s._v("#")]),s._v(" 使用 koa-static 生成图片链接")]),s._v(" "),t("ul",[t("li",[s._v("生成了静态服务")]),s._v(" "),t("li",[s._v("设置静态文件目录")]),s._v(" "),t("li",[s._v("生成图片链接")])]),s._v(" "),t("h2",{attrs:{id:"用户信息的-schema-设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户信息的-schema-设计"}},[s._v("#")]),s._v(" 用户信息的 schema 设计")]),s._v(" "),t("h2",{attrs:{id:"关注与取消关注"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关注与取消关注"}},[s._v("#")]),s._v(" 关注与取消关注")]),s._v(" "),t("ul",[t("li",[s._v("要理解当前用户和被关注的人之间的关系")]),s._v(" "),t("li",[s._v("我关注了一个人，那么我就是他的粉丝")]),s._v(" "),t("li",[s._v("可以推导出用户粉丝就是关注了我的人")])]),s._v(" "),t("h2",{attrs:{id:"校验用户存在与否的中间件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#校验用户存在与否的中间件"}},[s._v("#")]),s._v(" 校验用户存在与否的中间件")]),s._v(" "),t("h2",{attrs:{id:"话题模块功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#话题模块功能"}},[s._v("#")]),s._v(" 话题模块功能")]),s._v(" "),t("ul",[t("li",[s._v("话题的增改查")]),s._v(" "),t("li",[s._v("分页、模糊查询 .limit() .skip()")]),s._v(" "),t("li",[s._v("用户属性中的话题引用")]),s._v(" "),t("li",[s._v("关注/取消关注话题，用户关注的话题列表")])]),s._v(" "),t("h2",{attrs:{id:"模糊搜索-🔍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#模糊搜索-🔍"}},[s._v("#")]),s._v(" 模糊搜索 🔍")]),s._v(" "),t("ul",[t("li",[s._v("find({ name: new RegExp(ctx.query.q) })")])]),s._v(" "),t("h2",{attrs:{id:"用户属性中的话题引用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户属性中的话题引用"}},[s._v("#")]),s._v(" 用户属性中的话题引用")]),s._v(" "),t("ul",[t("li",[s._v('{ type: Schema.Types.ObjectId, ref: "Topic" }')]),s._v(" "),t("li",[s._v("populate('a b c')")]),s._v(" "),t("li",[s._v("使用话题引用替代部分用户属性")])]),s._v(" "),t("h2",{attrs:{id:"实现关注话题逻辑"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实现关注话题逻辑"}},[s._v("#")]),s._v(" 实现关注话题逻辑")]),s._v(" "),t("ul",[t("li",[s._v("用户-话题多对多关系")])]),s._v(" "),t("h2",{attrs:{id:"问题模块功能点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题模块功能点"}},[s._v("#")]),s._v(" 问题模块功能点")]),s._v(" "),t("ul",[t("li",[s._v("问题的增删改查")]),s._v(" "),t("li",[s._v("用户的问题列表（用户-问题一对多关系）")]),s._v(" "),t("li",[s._v("话题的问题列表+问题的话题列表（话题-问题多对多关系）")]),s._v(" "),t("li",[s._v("关注/取消关注问题")])]),s._v(" "),t("h3",{attrs:{id:"用户-问题一对多关系设计实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户-问题一对多关系设计实现"}},[s._v("#")]),s._v(" 用户-问题一对多关系设计实现")]),s._v(" "),t("ul",[t("li",[s._v("CURD 接口")]),s._v(" "),t("li",[s._v("显示用户的问题列表接口")])]),s._v(" "),t("h2",{attrs:{id:"话题-问题多对多关系设计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#话题-问题多对多关系设计"}},[s._v("#")]),s._v(" 话题-问题多对多关系设计")]),s._v(" "),t("ul",[t("li",[s._v("实现问题的话题列表接口")]),s._v(" "),t("li",[s._v("实现话题的问题列表接口")]),s._v(" "),t("li",[s._v("在问题中对话题进行关联，因为一个问题可能最对关联 5-10 个话题，但一个话题可能有成千上万的问题，所以不利于后端的接口字段的数据存储的大小。MongoDB 对每个字段的存储大小有限制")])]),s._v(" "),t("h2",{attrs:{id:"答案模块功能点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#答案模块功能点"}},[s._v("#")]),s._v(" 答案模块功能点")]),s._v(" "),t("ul",[t("li",[s._v("答案的增删改查")]),s._v(" "),t("li",[s._v("问题-答案/用户-答案一对多关心")]),s._v(" "),t("li",[s._v("赞/踩答案")]),s._v(" "),t("li",[s._v("收藏答案")])]),s._v(" "),t("h2",{attrs:{id:"答案接口用二级嵌套的方式实现-curd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#答案接口用二级嵌套的方式实现-curd"}},[s._v("#")]),s._v(" 答案接口用二级嵌套的方式实现 CURD")]),s._v(" "),t("ul",[t("li",[s._v("/questions/:id/answers")]),s._v(" "),t("li",[s._v("因为答案只能是某一个问题的")]),s._v(" "),t("li",[s._v("问题有很多答案，但答案只针对某一个问题")])]),s._v(" "),t("h2",{attrs:{id:"互斥关系的赞-踩答案接口设计与实现-6-个接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#互斥关系的赞-踩答案接口设计与实现-6-个接口"}},[s._v("#")]),s._v(" 互斥关系的赞/踩答案接口设计与实现 6 个接口")]),s._v(" "),t("ul",[t("li",[s._v("设计数据库 Schema")]),s._v(" "),t("li",[s._v("在用户的 Schema 放两个字段用于关联赞和踩的答案")]),s._v(" "),t("li",[s._v("互斥关系其实就是踩的时候要取消赞/赞的时候取消踩 （可以利用路由的中间件来实现）中间件应该要加 next")])]),s._v(" "),t("h2",{attrs:{id:"restful-风格的收藏答案接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#restful-风格的收藏答案接口"}},[s._v("#")]),s._v(" RESTful 风格的收藏答案接口")]),s._v(" "),t("h2",{attrs:{id:"问题-答案-评论模块三级嵌套的增删改查接口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题-答案-评论模块三级嵌套的增删改查接口"}},[s._v("#")]),s._v(" 问题-答案-评论模块三级嵌套的增删改查接口")]),s._v(" "),t("ul",[t("li",[s._v("参考 github 的评论接口：GET /repos/:owner/:repo/issues/:umber/comment")]),s._v(" "),t("li",[s._v('const router = new Router({ prefix: "/questions/:questionId/answers/:answerId/comments" })')])]),s._v(" "),t("h2",{attrs:{id:"一评论与二级评论接口的设计与实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一评论与二级评论接口的设计与实现"}},[s._v("#")]),s._v(" 一评论与二级评论接口的设计与实现")]),s._v(" "),t("ul",[t("li")]),s._v(" "),t("h2",{attrs:{id:"服务器的操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务器的操作"}},[s._v("#")]),s._v(" 服务器的操作")]),s._v(" "),t("ul",[t("li",[s._v("ssh 登录服务器 ssh root@ip")]),s._v(" "),t("li",[s._v("安装 Git，下载代码到服务器")]),s._v(" "),t("li",[s._v("安装 NodeJs，运行程序")])]),s._v(" "),t("h2",{attrs:{id:"用-nginx-实现端口转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用-nginx-实现端口转发"}},[s._v("#")]),s._v(" 用 Nginx 实现端口转发")]),s._v(" "),t("h2",{attrs:{id:"使用-pm2-管理进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-pm2-管理进程"}},[s._v("#")]),s._v(" 使用 PM2 管理进程")]),s._v(" "),t("ul",[t("li",[s._v("安装 PM2\n"),t("ul",[t("li",[s._v("npm i pm2 -g -d")])])]),s._v(" "),t("li",[s._v("使用 PM2 启动、停止、重启、重载程序\n"),t("ul",[t("li",[s._v("pm2 start appName")]),s._v(" "),t("li",[s._v("pm2 stop appName")]),s._v(" "),t("li",[s._v("pm2 restart appName")]),s._v(" "),t("li",[s._v("pm2 reload appName")]),s._v(" "),t("li",[s._v('NODE_ENV=production pm2 restart app --update-env --log-date-format "YYYY 年 MM 月 DD 日 HH:mm"')])])]),s._v(" "),t("li",[s._v("使用 PM2 日志、环境变量管理功能\n"),t("ul",[t("li",[s._v("NODE_ENV=production pm2 start app --update-env")])])])]),s._v(" "),t("h2",{attrs:{id:"使用企业级-node-js-egg-js"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用企业级-node-js-egg-js"}},[s._v("#")]),s._v(" 使用企业级 Node.js Egg.js")]),s._v(" "),t("h2",{attrs:{id:"掌握多进程编程知识"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#掌握多进程编程知识"}},[s._v("#")]),s._v(" 掌握多进程编程知识")]),s._v(" "),t("h2",{attrs:{id:"学习使用日志和性能监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#学习使用日志和性能监控"}},[s._v("#")]),s._v(" 学习使用日志和性能监控")])])}),[],!1,null,null,null);a.default=r.exports}}]);